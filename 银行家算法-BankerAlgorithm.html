<!DOCTYPE html><html class="theme-next pisces use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet"><link href="/css/main.css?v=5.1.4" rel="stylesheet"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="algorithm,"><meta name="description" content="最近上操作系统课解决死锁一节时，碰到了银行家算法这个算法。由于这个算法涉及的概念比较多，所以一开始在用编程实现这个算法的时候有点不知道怎样下手，在查了一些资料后总算是比较完美的写出来，这篇文章主要梳理一下银行家算法的几个关键点。完整的实验的源代码和测试截图我放到github上了。我自己的是c++版本的，文章的最后放了一个c语言版本的。如果对你有帮助，希望不要吝啬你的star。"><meta name="keywords" content="algorithm"><meta property="og:type" content="article"><meta property="og:title" content="银行家算法(BankerAlgorithm)"><meta property="og:url" content="http://www.lyreal666.com/银行家算法-BankerAlgorithm.html"><meta property="og:site_name" content="lyreal666&#39;s blog"><meta property="og:description" content="最近上操作系统课解决死锁一节时，碰到了银行家算法这个算法。由于这个算法涉及的概念比较多，所以一开始在用编程实现这个算法的时候有点不知道怎样下手，在查了一些资料后总算是比较完美的写出来，这篇文章主要梳理一下银行家算法的几个关键点。完整的实验的源代码和测试截图我放到github上了。我自己的是c++版本的，文章的最后放了一个c语言版本的。如果对你有帮助，希望不要吝啬你的star。"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://www.lyreal666.com/银行家算法-BankerAlgorithm/banker-algorithm-concept.jpg"><meta property="og:image" content="http://www.lyreal666.com/银行家算法-BankerAlgorithm/run-screenshot.jpg"><meta property="og:updated_time" content="2018-10-30T15:57:37.500Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="银行家算法(BankerAlgorithm)"><meta name="twitter:description" content="最近上操作系统课解决死锁一节时，碰到了银行家算法这个算法。由于这个算法涉及的概念比较多，所以一开始在用编程实现这个算法的时候有点不知道怎样下手，在查了一些资料后总算是比较完美的写出来，这篇文章主要梳理一下银行家算法的几个关键点。完整的实验的源代码和测试截图我放到github上了。我自己的是c++版本的，文章的最后放了一个c语言版本的。如果对你有帮助，希望不要吝啬你的star。"><meta name="twitter:image" content="http://www.lyreal666.com/银行家算法-BankerAlgorithm/banker-algorithm-concept.jpg"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://www.lyreal666.com/银行家算法-BankerAlgorithm.html"><title>银行家算法(BankerAlgorithm) | lyreal666's blog</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">lyreal666's blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">生命不息,折腾不止</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="menu-item-icon fa fa-fw fa-calendar"></i><br>日程表</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://www.lyreal666.com/银行家算法-BankerAlgorithm.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="yuTengJing"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="lyreal666's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">银行家算法(BankerAlgorithm)</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-21T16:58:00+08:00">2018-10-21</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/算法/" itemprop="url" rel="index"><span itemprop="name">算法</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>最近上操作系统课解决死锁一节时，碰到了银行家算法这个算法。由于这个算法涉及的概念比较多，所以一开始在用编程实现这个算法的时候有点不知道怎样下手，在查了一些资料后总算是比较完美的写出来，这篇文章主要梳理一下银行家算法的几个关键点。完整的实验的<a href="https://github.com/tjx666/osHomework/tree/master/experiment2/bankerAlgorithm" target="_blank" rel="noopener">源代码和测试截图</a>我放到github上了。我自己的是<code>c++</code>版本的，文章的最后放了一个<code>c语言</code>版本的。如果对你有帮助，希望不要吝啬你的star。</p><a id="more"></a><h2 id="银行家算法能解决可以什么问题"><a href="#银行家算法能解决可以什么问题" class="headerlink" title="银行家算法能解决可以什么问题"></a>银行家算法能解决可以什么问题</h2><p>其实我在学习编程的过程中，一直保持着这样一个原则:</p><blockquote><p>学习一个新知识新技术，一定要搞懂它可以做什么或者能解决什么问题。</p><p>如果你认为你已经学懂了，还是不知道它能干什么，可以不用继续研究它了，直接忘了它。</p></blockquote><p>银行家算法可以解决进程<strong>死锁</strong>的问题。</p><p>什么是死锁？拿一个关于死锁的很有名的问题-<code>哲学家就餐</code>问题来说明好了:</p><blockquote><p>哲学家就餐问题可以这样表述，假设有五位哲学家围坐在一张圆形餐桌旁，做以下两件事情之一：吃饭，或者思考。吃东西的时候，他们就停止思考，思考的时候也停止吃东西。餐桌中间有一大碗意大利面，每两个哲学家之间有一只餐叉。因为用一只餐叉很难吃到意大利面，所以假设哲学家必须用两只餐叉吃东西。他们只能使用自己左右手边的那两只餐叉。哲学家就餐问题有时也用米饭和筷子而不是意大利面和餐叉来描述，因为很明显，吃米饭必须用两根筷子。</p><p>哲学家从来不交谈，这就很危险，可能产生死锁，每个哲学家都拿着左手的餐叉，永远都在等右边的餐叉（或者相反）。即使没有死锁，也有可能发生资源耗尽。</p></blockquote><p>也就是说死锁就是由于陷入死锁的进程都在等待对方的资源，由于是相互等待对方结束，释放对方的资源，所以这个等待会永久持续下去，陷入死锁的进程无法结束。</p><p>银行家算法之所以叫银行家算法，那是因为一开始就是用来解决银行家碰到的问题，假设有这么一个场景：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A开发商想借20亿, 已经借了2亿，还需要18亿。</span><br><span class="line">B开发商想借18亿，已经借了3亿， 还需要15亿。</span><br><span class="line">C开发商想借8亿，借了7亿，需要1亿。</span><br><span class="line">银行家剩余8亿。</span><br></pre></td></tr></table></figure><p>作为一个银行家，肯定是想把钱借出去越多越好，满足所有开发商的需求，可能会有人像下面这么想：</p><p>因为剩下8亿只能借给C开发商，借给C开发商后银行家剩下7亿，A开发商和B开发商都没法借了，剩下的7亿根本不够A和B开发商尚需的18亿和15亿。</p><p>其实银行家算法中，这种没法满足所有开发商的尚需数的状态叫做<code>不安全状态</code>，只要有一个开发商无法借给它尚需的资金，都算是不安全的。A和B都在等待对方释放资金，但是银行家剩余的钱对A和B都无法满足它们的尚需数，A和B陷入了永久等待，没有一个开发商能继续下去，也就是死锁。</p><p>像上面这样想其实是不合的，出现问题的原因是：<strong>你只想着银行家剩下多少，却没想过能从别人那里收回多少。</strong></p><p>其实你借给C开发商后，因为C开发商已经满足了它最大需求8亿，它肯定是在有限时间内能够还回所有已经借的，即归还8亿，加上剩余的7亿，现在可以认为银行家有15亿。15亿借给B开发商，满足了它需要借的钱，所以可以回收已经借的3亿，就总共有了18亿，然后就可以借给A开发商了。这么算下来，银行家完全可以满足所有的开发商，找到了一个满足开发商需求的<code>安全序列</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C -&gt; B -&gt; A</span><br></pre></td></tr></table></figure><p>银行家算法中把当前分配情况下能找到这么一个序列满足所有进程需求的状态叫做<code>安全状态</code>。</p><p>上面的整个分析此时银行家是否处于安全状态就是<code>安全性检查</code>。</p><p>通过上面的讲解说明: 如果银行家当前可以满足某开发商尚需数，那么可以借给它尚需数，借给它之后，由于已经借了它需要的最大数，那么，在有限时间内就可以回收所有借给它的，银行家剩余资源反而会变多。</p><p>找安全序列的过程就是一个<strong>银行家不断使用剩余资金借某个尚需资金少于其剩余资金的开发商，把钱借给它，然后再整个回收借给它的资金，增加剩余资金，直到所有的开发商都获得了它的尚需资金的过程</strong>。这个过程中各个开发商按顺序连成了一个<code>安全序列</code>。</p><p>在进程死锁问题中，如果对于每一次的资源请求都:</p><ol><li>判断有没有必要尝试性分配</li><li>能够分配就尝试性分配</li><li>分配后进行安全性检查</li><li>检查不通过撤回分配</li><li>得出结论能否分配</li></ol><p>严格按照上面的操作得出的结果判断此次请求分配资源是否成功，不能分配就推迟，就可以保证所有进程都可以在有限时间获得其所需最大资源数，从而避免死锁的产生。</p><p>其实上面一已经提到了银行家算法中的几个概念，<code>安全状态</code>,<code>不安全状态</code>，<code>安全序列</code>，<code>安全性检查</code>。</p><h2 id="银行家算法中的一些概念"><a href="#银行家算法中的一些概念" class="headerlink" title="银行家算法中的一些概念"></a>银行家算法中的一些概念</h2><p>先来看一张网上找的<a href="https://blog.csdn.net/s634772208/article/details/46324257" target="_blank" rel="noopener">某博主</a>的一张概念图，估计是某本书的pdf截图:</p><p><img src="/银行家算法-BankerAlgorithm/banker-algorithm-concept.jpg" alt="银行家算法概念图:"></p><p>上面那张截图具体说明了银行家算法中涉及到的一些概念。下面再次对上面的那些概念做一个具体的说明:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">假设有总5个进程3类资源，i(0 &lt; i &lt; 5)和j(0 &lt; j&lt; 3)分别表示任意进程下标和资源下标。</span><br><span class="line">第一个进程到第5个进程分别为p[1], p[2], p[3], p[4], p[5]。</span><br><span class="line">从第一种资源到第三种资源分别为A, B, C。</span><br><span class="line">各进程分别的最大资源需求数:</span><br><span class="line">进程p[1]  7    5    3</span><br><span class="line">进程p[2]  3    2    2</span><br><span class="line">进程p[3]  9    0    2</span><br><span class="line">进程p[4]  2    2    2</span><br><span class="line">进程p[5]  4    3    3</span><br></pre></td></tr></table></figure><ul><li>剩余资源数 <strong>availible</strong>，这是一个数组，每一个元素都是表示一种操作系统剩余资源数。 <code>avaible[2]</code>就表示操作系统C类资源剩余数。</li><li>最大需求数 <strong>max</strong>，是一个二维数组。在我的源代码里面改成了maxNeed,因为max是c++标准库里面的函数，命名会冲突。<code>max[0][0]</code>就表示p[1]进程的A类资源。</li><li>占用资源数 <strong>allocation</strong>, 这也是一个二维数组。<code>allocation[1][2]</code>就表示p[2]进程的C类资源的占用，换句话说就是操作系统已经分配给p[2]进程的C类资源。很显然，最开始<code>allocatin[i][j]</code>为0.</li><li>尚需数 <strong>need</strong>，这也是一个二维数组，<code>need[3][0]</code>就表示p[4]进程对A类资源还需要多少。很显然，最开始need等于max。并且<code>max[i][j]</code> == <code>allocation[i][j]</code> + <code>need[i][j]</code>。</li><li>当前请求的资源数 <strong>request</strong>，一个二维数组。<code>request[2][2]</code>就表示p[3]进程对C类资源的请求数量。很显然, <code>request[i][j]</code>&lt;= <code>need[j][j]</code>。</li><li>是否完成 <strong>completed</strong>，<strong>bool</strong>类型数组。这个是我为了方便表示某个进程是否已经结束资源请求自己加的。<code>completed[0]</code>表示p[1]进程已经结束资源请求。</li><li>工作向量 <strong>work</strong>，这是一个数组。表示的是在安全性检验时用来表示当前某类资源的剩余资源数。<code>work[2]</code>就表示C类资源的在安全性检验算法中的剩余数。显然不能用<strong>availble</strong>在安全性检验中表示资源剩余数，因为安全性检验只是一种推算，并不是实际发生的请求分配。</li><li>是否结束了资源请求 <strong>finish</strong>，这也是个<strong>bool</strong>类型数组。和上面的<strong>work</strong>一样，都是在安全性检验中才用到的变量，<code>finish[4]</code>为true就表示在安全性检验中p[5]已经结束资源请求。</li></ul><h2 id="程序代码分析"><a href="#程序代码分析" class="headerlink" title="程序代码分析"></a>程序代码分析</h2><p>下面来具体对某次请求进行代码分析。</p><h3 id="先得判断有没有必要进行尝试性分配"><a href="#先得判断有没有必要进行尝试性分配" class="headerlink" title="先得判断有没有必要进行尝试性分配"></a>先得判断有没有必要进行尝试性分配</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果该进程需要的资源都已经分配完了，还请求分配，显然不正常。</span></span><br><span class="line"><span class="keyword">if</span> (completed[processIndex]) &#123;</span><br><span class="line">        <span class="built_in">cerr</span> &lt;&lt; <span class="string">"进程p["</span> &lt;&lt; processIndex + <span class="number">1</span> &lt;&lt; <span class="string">"]已经结束了,不允许再次申请!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        requestFailedType = RequestFailedType::COMPLETED_PROCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 显然 request[i][j] &lt;= need[i][j]</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">    <span class="keyword">if</span> (request[processIndex][j] &gt; need[processIndex][j]) &#123;</span><br><span class="line">        <span class="built_in">cerr</span> &lt;&lt; <span class="string">"对资源"</span> &lt;&lt; <span class="keyword">char</span>(<span class="number">65</span> + j) &lt;&lt; <span class="string">"请求的资源总和超出记录的最大值"</span> &lt;&lt; maxNeed[processIndex][j] &lt;&lt; <span class="string">"，请求资源失败！！！"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        requestFailedType = RequestFailedType::MORE_THAN_MAX;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果操作系统每一类资源都能满足此次请求</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">    <span class="keyword">if</span> (request[processIndex][j] &gt; available[j]) &#123;</span><br><span class="line">        requestFailedType = RequestFailedType::NOT_AVAILABLE;</span><br><span class="line">        <span class="built_in">cerr</span> &lt;&lt; <span class="string">"系统可获得"</span> &lt;&lt; <span class="keyword">char</span>(<span class="number">65</span> + j) &lt;&lt; <span class="string">"类资源不足，只有"</span> &lt;&lt; available[j] &lt;&lt; <span class="string">"，请求资源失败！！！"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="尝试性分配"><a href="#尝试性分配" class="headerlink" title="尝试性分配"></a>尝试性分配</h3><p>当上面3个条件都满足了，进行尝试新分配。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 尝试性分配</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">    need[processIndex][j] -= request[processIndex][j];</span><br><span class="line">    available[j] -= request[processIndex][j];</span><br><span class="line">    allocation[processIndex][j] += request[processIndex][j];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 别忘了尝试新分配时如果当前分配的每一类资源数等于need，即对于该进程资源分配结束，就可以回收其资源。</span></span><br><span class="line"><span class="keyword">if</span> (isDone(processIndex)) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">        available[j] += maxNeed[processIndex][j];</span><br><span class="line">    &#125;</span><br><span class="line">    completed[processIndex] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分配之后要进行安全性检查"><a href="#分配之后要进行安全性检查" class="headerlink" title="分配之后要进行安全性检查"></a>分配之后要进行安全性检查</h3><p>对于一个进程的某一次请求，能否请求成功还得看尝试性分配后是否处于安全状态，也就是说能不能找到一个安全序列。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 从进程列表种选择一个可以满足资源需求的进程</span></span><br><span class="line"><span class="comment"> * @param processIndex</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">selectProcess</span><span class="params">(<span class="keyword">int</span>* processIndex)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) &#123;</span><br><span class="line">       <span class="comment">// 如果已经资源请求结束了或者在安全性检查中已经获得了尚需数直接跳过</span></span><br><span class="line">        <span class="keyword">if</span> (completed[i] || finish[i]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (need[i][j] &gt; work[j]) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (j == resourceTypes)  &#123;</span><br><span class="line">            *processIndex = i;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 安全性检验</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">checkSafety</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 重置所有的进程finish为false, 并初始化工作向量为当前系统可获得资源数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) finish[i] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) work[j] = available[j];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> processIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (selectProcess((&amp;processIndex))) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) work[j] += allocation[processIndex][j];</span><br><span class="line">        safeSeries[index] = processIndex;</span><br><span class="line">        finish[processIndex] = <span class="literal">true</span>;</span><br><span class="line">        ++index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (index = <span class="number">0</span>; index &lt; processCount; ++index) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!completed[index] &amp;&amp; !finish[index]) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> index == processCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="安全性检查不通过"><a href="#安全性检查不通过" class="headerlink" title="安全性检查不通过"></a>安全性检查不通过</h3><p>找不到一个安全序列，sorry，请求失败，不要忘记撤回之前尝试性分配的操作!</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!checkSafety()) &#123;</span><br><span class="line">    <span class="comment">// 不通过，撤回操作完全就是是尝试性分配操作的一个逆操作</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">        need[processIndex][j] += request[processIndex][j];</span><br><span class="line">        available[j] += request[processIndex][j];</span><br><span class="line">        <span class="keyword">if</span> (isDone(processIndex)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; resourceTypes; ++k) &#123;</span><br><span class="line">                available[j] -= maxNeed[processIndex][j];</span><br><span class="line">            &#125;</span><br><span class="line">            completed[processIndex] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        allocation[processIndex][j] -= request[processIndex][j];</span><br><span class="line">    &#125;</span><br><span class="line">    requestFailedType = RequestFailedType::NO_SAFE_LIST;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"资源剩余数:"</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; resourceTypes; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"\t"</span> &lt;&lt; available[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 最大进程数和资源种类数</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_PROCESS_COUNT = <span class="number">50</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_RESOURCE_TYPES = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基本数据结构</span></span><br><span class="line"><span class="keyword">int</span>* available = <span class="keyword">new</span> <span class="keyword">int</span>[MAX_PROCESS_COUNT];</span><br><span class="line"><span class="keyword">int</span>** maxNeed = <span class="keyword">new</span> <span class="keyword">int</span>*[MAX_PROCESS_COUNT];</span><br><span class="line"><span class="keyword">int</span>** allocation = <span class="keyword">new</span> <span class="keyword">int</span>*[MAX_PROCESS_COUNT];</span><br><span class="line"><span class="keyword">int</span>** need = <span class="keyword">new</span> <span class="keyword">int</span>*[MAX_PROCESS_COUNT];</span><br><span class="line"><span class="keyword">int</span>** request = <span class="keyword">new</span> <span class="keyword">int</span>*[MAX_PROCESS_COUNT];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 安全性检查算法中的数据结构</span></span><br><span class="line"><span class="comment">// work: 是表示安全性检查算法种当前某类资源可获得数</span></span><br><span class="line"><span class="comment">// finish: 表示在找安全序列时进程的资源请求是否结束,也就是need[i][j] &lt;= available[j]</span></span><br><span class="line"><span class="comment">// safeSeries: 表示安全序列数组</span></span><br><span class="line"><span class="keyword">int</span>* work = <span class="keyword">new</span> <span class="keyword">int</span>[MAX_PROCESS_COUNT];</span><br><span class="line"><span class="keyword">bool</span>* finish = <span class="keyword">new</span> <span class="keyword">bool</span>[MAX_PROCESS_COUNT];</span><br><span class="line"><span class="keyword">int</span>* safeSeries = <span class="keyword">new</span> <span class="keyword">int</span>[MAX_PROCESS_COUNT];</span><br><span class="line"><span class="keyword">bool</span>* completed = <span class="keyword">new</span> <span class="keyword">bool</span>[MAX_PROCESS_COUNT];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当前进程数和资源种类数</span></span><br><span class="line"><span class="keyword">int</span> processCount;</span><br><span class="line"><span class="keyword">int</span> resourceTypes;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 表示一串资源类别字母，比如输入资源类别数量为3就是 A    B    C</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> letterColumnStr;</span><br><span class="line"><span class="comment">// 表示求失败的原因种类</span></span><br><span class="line"><span class="keyword">enum</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestFailedType</span> &#123;</span>MORE_THAN_MAX, NOT_AVAILABLE, NO_SAFE_LIST, COMPLETED_PROCESS&#125; requestFailedType;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 初始化数据结构</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initDataStructure</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> length = MAX_PROCESS_COUNT;</span><br><span class="line">    <span class="keyword">while</span> (length--) &#123;</span><br><span class="line">        maxNeed[length] = <span class="keyword">new</span> <span class="keyword">int</span>[MAX_RESOURCE_TYPES];</span><br><span class="line">        allocation[length] = <span class="keyword">new</span> <span class="keyword">int</span>[MAX_RESOURCE_TYPES];</span><br><span class="line">        need[length] = <span class="keyword">new</span> <span class="keyword">int</span>[MAX_RESOURCE_TYPES];</span><br><span class="line">        request[length] = <span class="keyword">new</span> <span class="keyword">int</span>[MAX_RESOURCE_TYPES];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化各进程资源占用为0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) &#123;</span><br><span class="line">        completed[i] = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            allocation[i][j] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 回收内存</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reclaimMemory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">delete</span>[] available;</span><br><span class="line">    <span class="keyword">delete</span>[] work;</span><br><span class="line">    <span class="keyword">delete</span>[] finish;</span><br><span class="line">    <span class="keyword">delete</span>[] safeSeries;</span><br><span class="line">    <span class="keyword">delete</span>[] completed;</span><br><span class="line">    <span class="keyword">int</span> length = MAX_PROCESS_COUNT;</span><br><span class="line">    <span class="keyword">while</span> (length--) &#123;</span><br><span class="line">        <span class="keyword">delete</span>[] maxNeed[length];</span><br><span class="line">        <span class="keyword">delete</span>[] allocation[length];</span><br><span class="line">        <span class="keyword">delete</span>[] need[length];</span><br><span class="line">        <span class="keyword">delete</span>[] request[length];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">delete</span>[] maxNeed;</span><br><span class="line">        <span class="keyword">delete</span>[] allocation;</span><br><span class="line">        <span class="keyword">delete</span>[] need;</span><br><span class="line">        <span class="keyword">delete</span>[] request;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断某进程是否资源请求是否结束</span></span><br><span class="line"><span class="comment"> * @param processIndex</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isDone</span><span class="params">(<span class="keyword">int</span> processIndex)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">        <span class="keyword">if</span> (need[processIndex][j] != <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="class"><span class="keyword">class</span> <span class="title">SafeSeriesMode</span> &#123;</span> NORMAL, SUCCESS, FAILED&#125;;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 打印安全序列</span></span><br><span class="line"><span class="comment"> * @param mode</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printSafeSeries</span><span class="params">(<span class="keyword">const</span> SafeSeriesMode mode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> notCopletedCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!completed[i]) ++notCopletedCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">stringstream</span> ss;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> seriesString;</span><br><span class="line">    <span class="keyword">if</span> (notCopletedCount != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> pIndex = <span class="number">0</span>; pIndex &lt; notCopletedCount - <span class="number">1</span>; ++pIndex) ss &lt;&lt; <span class="string">"p["</span> &lt;&lt; safeSeries[pIndex] + <span class="number">1</span> &lt;&lt; <span class="string">"] -&gt; "</span>;</span><br><span class="line">        ss &lt;&lt; <span class="string">"p["</span> &lt;&lt; safeSeries[notCopletedCount - <span class="number">1</span>] + <span class="number">1</span> &lt;&lt; <span class="string">"]"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">        seriesString = ss.str();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (mode) &#123;</span><br><span class="line">        <span class="keyword">case</span> SafeSeriesMode::NORMAL :</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"\n安全序列:"</span> &lt;&lt; seriesString;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> SafeSeriesMode::SUCCESS :</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"申请成功!\t\t安全序列为:"</span> &lt;&lt; seriesString;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> SafeSeriesMode::FAILED :</span><br><span class="line">            <span class="built_in">cerr</span> &lt;&lt; <span class="string">"无安全序列,申请不成功"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 调试用的, 打印选择了一个进程后的当前状态</span></span><br><span class="line"><span class="comment"> * @param processIndex</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printSelection</span><span class="params">(<span class="keyword">int</span> processIndex)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"\n选择的是p["</span> &lt;&lt; processIndex + <span class="number">1</span> &lt;&lt; <span class="string">"]"</span> &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Work: "</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; work[j] &lt;&lt; <span class="string">"    "</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    printSafeSeries(SafeSeriesMode::NORMAL);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"finish: "</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; finish[i] &lt;&lt; <span class="string">"    "</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"剩余资源:"</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"\t"</span> &lt;&lt; available[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 打印当前进程状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printProcessState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程名 \t\t最大需求量\t\t尚需求量\t\t已分配量\t\t执行结束否"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"\t\t"</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; resourceTypes; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"\t"</span> &lt;&lt; letterColumnStr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程p["</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="string">"]\t\t"</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; maxNeed[i][j] &lt;&lt; <span class="string">"\t"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"\t"</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; need[i][j] &lt;&lt; <span class="string">"\t"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"\t"</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; allocation[i][j] &lt;&lt; <span class="string">"\t"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; (isDone(i) ? <span class="string">"finished"</span> : <span class="string">"working"</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"资源剩余数:"</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; resourceTypes; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"\t"</span> &lt;&lt; available[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 从进程列表种选择一个可以满足资源需求的进程</span></span><br><span class="line"><span class="comment"> * @param processIndex</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">selectProcess</span><span class="params">(<span class="keyword">int</span>* processIndex)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (completed[i] || finish[i]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (need[i][j] &gt; work[j]) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (j == resourceTypes)  &#123;</span><br><span class="line">            *processIndex = i;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 安全性检验</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">checkSafety</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 重置所有的进程finish为false, 并初始化工作向量为当前系统可获得资源数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) finish[i] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) work[j] = available[j];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> processIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (selectProcess((&amp;processIndex))) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) work[j] += allocation[processIndex][j];</span><br><span class="line">        safeSeries[index] = processIndex;</span><br><span class="line">        finish[processIndex] = <span class="literal">true</span>;</span><br><span class="line">        ++index;</span><br><span class="line"><span class="comment">//        printSelection(processIndex);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (index = <span class="number">0</span>; index &lt; processCount; ++index) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!completed[index] &amp;&amp; !finish[index]) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> index == processCount;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 银行家算法</span></span><br><span class="line"><span class="comment"> * @param processIndex</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bankerAlgorithm</span><span class="params">(<span class="keyword">int</span> processIndex)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (completed[processIndex]) &#123;</span><br><span class="line">        <span class="built_in">cerr</span> &lt;&lt; <span class="string">"进程p["</span> &lt;&lt; processIndex + <span class="number">1</span> &lt;&lt; <span class="string">"]已经结束了,不允许再次申请!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        requestFailedType = RequestFailedType::COMPLETED_PROCESS;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">        <span class="keyword">if</span> (request[processIndex][j] &gt; need[processIndex][j]) &#123;</span><br><span class="line">            <span class="built_in">cerr</span> &lt;&lt; <span class="string">"对资源"</span> &lt;&lt; <span class="keyword">char</span>(<span class="number">65</span> + j) &lt;&lt; <span class="string">"请求的资源总和超出记录的最大值"</span> &lt;&lt; maxNeed[processIndex][j] &lt;&lt; <span class="string">"，请求资源失败！！！"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            requestFailedType = RequestFailedType::MORE_THAN_MAX;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">        <span class="keyword">if</span> (request[processIndex][j] &gt; available[j]) &#123;</span><br><span class="line">            requestFailedType = RequestFailedType::NOT_AVAILABLE;</span><br><span class="line">            <span class="built_in">cerr</span> &lt;&lt; <span class="string">"系统可获得"</span> &lt;&lt; <span class="keyword">char</span>(<span class="number">65</span> + j) &lt;&lt; <span class="string">"类资源不足，只有"</span> &lt;&lt; available[j] &lt;&lt; <span class="string">"，请求资源失败！！！"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 尝试性分配</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">        need[processIndex][j] -= request[processIndex][j];</span><br><span class="line">        available[j] -= request[processIndex][j];</span><br><span class="line">        allocation[processIndex][j] += request[processIndex][j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isDone(processIndex)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            available[j] += maxNeed[processIndex][j];</span><br><span class="line">        &#125;</span><br><span class="line">        completed[processIndex] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!checkSafety()) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            need[processIndex][j] += request[processIndex][j];</span><br><span class="line">            available[j] += request[processIndex][j];</span><br><span class="line">            <span class="keyword">if</span> (isDone(processIndex)) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; resourceTypes; ++k) &#123;</span><br><span class="line">                    available[j] -= maxNeed[processIndex][j];</span><br><span class="line">                &#125;</span><br><span class="line">                completed[processIndex] = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            allocation[processIndex][j] -= request[processIndex][j];</span><br><span class="line">        &#125;</span><br><span class="line">        requestFailedType = RequestFailedType::NO_SAFE_LIST;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"资源剩余数:"</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; resourceTypes; ++i) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"\t"</span> &lt;&lt; available[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 初始化当前系统各类资源可获得数</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入进程数: "</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; processCount;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入资源种类数: "</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; resourceTypes;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入当前系统"</span> &lt;&lt; resourceTypes &lt;&lt; <span class="string">"种资源各自能获得的最大数: "</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; resourceTypes; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; available[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化各进程各类资源所需最大资源数, 此时need == maxNeed;</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"\n请输入"</span> &lt;&lt; processCount &lt;&lt; <span class="string">"个进程的:"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程名 \t\t最大需求量(max)"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i= <span class="number">0</span>; i &lt; resourceTypes; ++i) &#123;</span><br><span class="line">        letterColumnStr += <span class="keyword">char</span>(<span class="number">65</span> + i);</span><br><span class="line">        letterColumnStr += <span class="string">"\t"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"    \t\t"</span> &lt;&lt; letterColumnStr &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程p["</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="string">"]\t\t"</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; maxNeed[i][j];</span><br><span class="line">            need[i][j] = maxNeed[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输入个进程第一次申请的资源数</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"\n请输入"</span> &lt;&lt; processCount &lt;&lt; <span class="string">"个进程的:"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程名 \t\t第一次申请量(request)"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"    \t\t"</span> &lt;&lt; letterColumnStr &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; processCount; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程p["</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="string">"]\t\t"</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; request[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (bankerAlgorithm(i)) &#123;</span><br><span class="line">            printSafeSeries(SafeSeriesMode::SUCCESS);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"分配不成功，失败原因: "</span> &lt;&lt; <span class="keyword">int</span>(requestFailedType) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    printProcessState();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> ifRequestAgain = <span class="string">"N"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"是否需要再申请资源?    (Y/N)"</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; ifRequestAgain;</span><br><span class="line">    <span class="keyword">while</span> (ifRequestAgain == <span class="string">"Y"</span> || ifRequestAgain == <span class="string">"y"</span>) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入进程编号(1-"</span> &lt;&lt; processCount &lt;&lt; <span class="string">") p: "</span>;</span><br><span class="line">        <span class="keyword">int</span> processIndex;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; processIndex;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入进程p["</span> &lt;&lt; processIndex &lt;&lt; <span class="string">"]对"</span> &lt;&lt; resourceTypes &lt;&lt; <span class="string">"类资源的申请: "</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; resourceTypes; ++j) &#123;</span><br><span class="line">                <span class="built_in">cin</span> &gt;&gt; request[processIndex - <span class="number">1</span>][j];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (bankerAlgorithm(processIndex - <span class="number">1</span>)) &#123;</span><br><span class="line">                printSafeSeries(SafeSeriesMode::SUCCESS);</span><br><span class="line">                printProcessState();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (requestFailedType != RequestFailedType::NO_SAFE_LIST) &#123;</span><br><span class="line">                    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请重新输入该进程资源的申请: "</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    printSafeSeries(SafeSeriesMode::FAILED);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"\n是否需要再申请资源?    (Y/N)"</span>;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; ifRequestAgain;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    initDataStructure();</span><br><span class="line">    input();</span><br><span class="line">    reclaimMemory();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"输入回车结束..."</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cin</span>.get();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="代码运行截图"><a href="#代码运行截图" class="headerlink" title="代码运行截图"></a>代码运行截图</h2><p><img src="/银行家算法-BankerAlgorithm/run-screenshot.jpg" alt="运行截图"></p><h2 id="同学的C语言版"><a href="#同学的C语言版" class="headerlink" title="同学的C语言版"></a>同学的C语言版</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX 20<span class="comment">//本次宏设置用于调整MAX的大小</span></span></span><br><span class="line"><span class="keyword">int</span> N,M;<span class="comment">//N是资源数，M表示进程数</span></span><br><span class="line"><span class="keyword">int</span> need[MAX][MAX];<span class="comment">//P[i]尚需j类资源的数量</span></span><br><span class="line"><span class="keyword">int</span> available[MAX];<span class="comment">//某类资源的可用量</span></span><br><span class="line"><span class="keyword">int</span> vurtualavailable[MAX];<span class="comment">//某类资源的可用量</span></span><br><span class="line"><span class="keyword">int</span> max[MAX][MAX];<span class="comment">//P[i]对资源j类的最大需求量</span></span><br><span class="line"><span class="keyword">int</span> allocate[MAX][MAX]; <span class="comment">//p[i]在j类资源已分配的资源量</span></span><br><span class="line"><span class="keyword">int</span> finish[MAX]= &#123;<span class="number">0</span>&#125;; <span class="comment">//P[i]进程是否执行结束</span></span><br><span class="line"><span class="keyword">int</span> request[MAX][MAX];<span class="comment">//进程对某类资源的申请量</span></span><br><span class="line"><span class="keyword">int</span> Flag[MAX]= &#123;<span class="number">0</span>&#125;;<span class="comment">//P[i]进程是否已经满足全部所需资源</span></span><br><span class="line"><span class="keyword">int</span> s[MAX];<span class="comment">//记录安全序列数组</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">selectProcess</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compareNeedAndAvailable</span><span class="params">(<span class="keyword">int</span> i)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//安全性检查</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">saftfty</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j,k,tru,t;</span><br><span class="line">    tru = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">    &#123;</span><br><span class="line">       available[j] = available[j] - request[i][j];</span><br><span class="line">       need[i][j] = need[i][j] - request[i][j];</span><br><span class="line">       allocate[i][j] = max[i][j] - need[i][j];</span><br><span class="line">       <span class="keyword">if</span>(need[i][j] != <span class="number">0</span>)</span><br><span class="line">        tru = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tru == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        finish[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            available[j] = available[j] + max[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tru = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; MAX;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        Flag[j]= <span class="number">0</span>;</span><br><span class="line">        s[j]= <span class="number">0</span>;</span><br><span class="line">        vurtualavailable[j] = available[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; MAX;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(finish[j] == <span class="number">1</span>)</span><br><span class="line">            Flag[j] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(k = <span class="number">0</span>;k &lt; M;k++)</span><br><span class="line">    &#123;</span><br><span class="line">        j = selectProcess();</span><br><span class="line">        <span class="keyword">if</span>(j != <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            s[k] = j+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(t = <span class="number">0</span>;t &lt; N;t++)</span><br><span class="line">                available[t] = available[t] + allocate[j][t];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(k = <span class="number">0</span>;k &lt; M;k++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Flag[k] != <span class="number">1</span>)</span><br><span class="line">            tru = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; MAX;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        available[j] = vurtualavailable[j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tru == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">        &#123;</span><br><span class="line">           available[j] = available[j] + request[i][j];</span><br><span class="line">           need[i][j] = need[i][j] + request[i][j];</span><br><span class="line">           allocate[i][j] = max[i][j] - need[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//从进程队列选择一个符合要求的进程</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">selectProcess</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i&lt; M;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(finish[i] != <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">if</span>(Flag[i] != <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(compareNeedAndAvailable(i) == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Flag[i] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进程资源尚需量加上系统可用资源数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addNeedAndAvailable</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">    &#123;</span><br><span class="line">       available[j] +=  need[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//比较某个进程资源尚需量和系统可用资源数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compareNeedAndAvailable</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(need[i][j] &gt; available[j])</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//进程资源尚需量大于资源的可用量返回1；</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//比较某个进程的最大需求量和系统可用资源数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compareMaxAndAvailable</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(max[i][j] &gt; available[j])</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//最大需求量大于资源的可用量返回1；</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//比较某个进程的申请量和尚需资源的数量</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compareRequestAndNeed</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(request[i][j] &gt; need[i][j])</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//申请量大于尚需资源的数量返回1；</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//比较某个进程的申请量和系统可用资源数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compareRequestAndAvailable</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(request[i][j] &gt; available[j])</span><br><span class="line">            <span class="keyword">return</span> j;<span class="comment">//申请量大于系统可用资源数返回1；</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输入最大需求量</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inputMax</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    i = j = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n\n请输入%d个进程的：\n进程名      最大需求量：\n"</span>,M);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"             "</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">" %c"</span>,(i+<span class="number">65</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; M;i++)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"进程P[%d]      "</span>,i+<span class="number">1</span>);</span><br><span class="line">       <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">       &#123;</span><br><span class="line">          <span class="built_in">scanf</span>(<span class="string">" %d"</span>,&amp;max[i][j]);</span><br><span class="line">          need[i][j] = max[i][j];</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span>(compareMaxAndAvailable(i<span class="number">-1</span>))</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"进程[%d]的资源最大需求量大于系统可用资源数"</span>,i);</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输入第一次申请量并输出安全队列</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inputFirstRequest</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,k;</span><br><span class="line">    i = j = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n\n请输入%d个进程的：\n进程名      第一次申请量：\n"</span>,M);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"             "</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">" %c"</span>,(i+<span class="number">65</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; M;i++)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"进程P[%d]      "</span>,i+<span class="number">1</span>);</span><br><span class="line">       <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">       &#123;</span><br><span class="line">          <span class="built_in">scanf</span>(<span class="string">" %d"</span>,&amp;request[i][j]);</span><br><span class="line">       &#125;</span><br><span class="line">        <span class="keyword">if</span>(saftfty(i))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"申请成功！安全序列为："</span>);</span><br><span class="line">            <span class="keyword">for</span>(k = <span class="number">0</span>;k &lt; M;k++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(s[k] != <span class="number">0</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"p[%d]"</span>,s[k]);</span><br><span class="line">                <span class="keyword">if</span>(k &lt; M<span class="number">-1</span>)</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"--&gt;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"无安全序列，申请不成功！"</span>);</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    output();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//再次输入申请量</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inputRequest</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,a;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入进程编号（1-5）p:"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;i);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入进程p[%d]对%d类资源的申请数："</span>,i,N);</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">" %d"</span>,&amp;request[i<span class="number">-1</span>][j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(compareRequestAndNeed(i<span class="number">-1</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"进程[%d]的资源申请量大于尚需量"</span>,i);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(compareRequestAndAvailable(i<span class="number">-1</span>) != <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        a = compareRequestAndAvailable(i<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">while</span>(a != <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"申请资源数超过系统可用资源量,你%c类可用资源为%d\n"</span>,a+<span class="number">65</span>,available[a]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"请重新输入这个进程的申请信息！\n"</span>);</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">" %d"</span>,&amp;request[i<span class="number">-1</span>][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        a = compareRequestAndAvailable(i<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">if</span>(saftfty(i<span class="number">-1</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"申请成功！安全序列为："</span>);</span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; M;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(s[i] != <span class="number">0</span>)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"p[%d]--&gt;"</span>,s[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"无安全序列，申请不成功！"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    output();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出进程状态</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    j = <span class="number">3</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"进程名  \t最大需求量\t尚需求量\t已分配量\t执行结束否\n  "</span>);</span><br><span class="line">    <span class="keyword">while</span>(j&gt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\t\t"</span>);</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; N;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">" %c"</span>,(i+<span class="number">65</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        j--;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; M;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"进程p[%d]"</span>,i+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\t"</span>);</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">" %d"</span>,max[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">         <span class="built_in">printf</span>(<span class="string">"\t\t"</span>);</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">" %d"</span>,need[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\t\t"</span>);</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">" %d"</span>,allocate[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\t"</span>);</span><br><span class="line">        <span class="keyword">if</span>(finish[i] == <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"\tworking"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"剩余资源数:   "</span>);</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; N;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">" %d"</span>,available[j]);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">char</span> a = <span class="string">'y'</span>;</span><br><span class="line">    i = j = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入资源种类："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;N);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n请输入进程数："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;M);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n请输入%d类资源初始化的资源数："</span>,N);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="built_in">scanf</span>(<span class="string">" %d"</span>,&amp;available[i]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    inputMax();</span><br><span class="line">    inputFirstRequest();</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"是否需要再申请资源？（Y/N）   "</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">" %c"</span>,&amp;a);</span><br><span class="line">    <span class="keyword">if</span>(a == <span class="string">'N'</span> || a == <span class="string">'n'</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    inputRequest();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div><div><div style="text-align:left;color:#666;font-size:14px">(完)</div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/algorithm/" rel="tag"># algorithm</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/SSH知识总结.html" rel="next" title="SSH知识总结"><i class="fa fa-chevron-left"></i> SSH知识总结</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/linux常用命令.html" rel="prev" title="linux常用命令">linux常用命令<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="yuTengJing"><p class="site-author-name" itemprop="name">yuTengJing</p><p class="site-description motion-element" itemprop="description">爱好编程的大三dog</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">11</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">17</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="2713151713@qq.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#银行家算法能解决可以什么问题"><span class="nav-number">1.</span> <span class="nav-text">银行家算法能解决可以什么问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#银行家算法中的一些概念"><span class="nav-number">2.</span> <span class="nav-text">银行家算法中的一些概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#程序代码分析"><span class="nav-number">3.</span> <span class="nav-text">程序代码分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#先得判断有没有必要进行尝试性分配"><span class="nav-number">3.1.</span> <span class="nav-text">先得判断有没有必要进行尝试性分配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#尝试性分配"><span class="nav-number">3.2.</span> <span class="nav-text">尝试性分配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分配之后要进行安全性检查"><span class="nav-number">3.3.</span> <span class="nav-text">分配之后要进行安全性检查</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安全性检查不通过"><span class="nav-number">3.4.</span> <span class="nav-text">安全性检查不通过</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#完整代码"><span class="nav-number">4.</span> <span class="nav-text">完整代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码运行截图"><span class="nav-number">5.</span> <span class="nav-text">代码运行截图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#同学的C语言版"><span class="nav-number">6.</span> <span class="nav-text">同学的C语言版</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">yuTengJing</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script src="/js/src/utils.js?v=5.1.4"></script><script src="/js/src/motion.js?v=5.1.4"></script><script src="/js/src/affix.js?v=5.1.4"></script><script src="/js/src/schemes/pisces.js?v=5.1.4"></script><script src="/js/src/scrollspy.js?v=5.1.4"></script><script src="/js/src/post-details.js?v=5.1.4"></script><script src="/js/src/bootstrap.js?v=5.1.4"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script></body></html>